"use strict";var APP=angular.module("app",["ui.router","ngScrollbars","ngCookies","validation","moment-picker","LocalStorageModule","cp.ngConfirm","ngLess"]);APP.constant("loginMode",{NAME:"LOGINMODE",RESULT:"success"}),APP.run(["$rootScope","$log","$timeout","loginMode","$state","$stateParams",function(t,e,o,n,i,r){t.$state=i,t.$stateParams=r,t.$on("LocalStorageModule.notification.setitem",function(t,o){o&&o.key==n.NAME&&e.info("用户正在尝试登陆")}),t.$on("LocalStorageModule.notification.removeitem",function(t,o){o&&o.key==n.NAME&&e.info("用户正在退出登陆")})}]),APP.config(["localStorageServiceProvider",function(t){t.setPrefix("XIZHUOKEJI").setStorageType("sessionStorage").setNotify(!0,!0)}]),APP.config(["momentPickerProvider",function(t){t.options({locale:"en",format:"L LTS",minView:"decade",maxView:"minute",startView:"year",autoclose:!0,today:!1,keyboard:!1,leftArrow:"&larr;",rightArrow:"&rarr;",yearsFormat:"YYYY",monthsFormat:"MMM",daysFormat:"D",hoursFormat:"HH:[00]",minutesFormat:moment.localeData().longDateFormat("LT").replace(/[aA]/,""),secondsFormat:"ss",minutesStep:5,secondsStep:1})}]),APP.config(["$qProvider",function(t){}]),APP.config(["$sceDelegateProvider",function(t){t.resourceUrlWhitelist(["*://localhost:8080/**","self"])}]),APP.config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("login",{url:"/login",templateUrl:"script/platform/component/login/login.html",controller:"loginCtrl"}).state("home",{url:"/home",templateUrl:"script/platform/component/home/home.html",controller:"homeCtrl"}).state("home.main",{url:"/main",templateUrl:"script/platform/component/home/main/main.html",controller:"mainCtrl"}).state("home.organization",{url:"/organization",templateUrl:"script/platform/component/home/organization/organization.html",controller:"organizationCtrl"}),e.otherwise("login")}]),APP.config(["ScrollBarsProvider",function(t){t.defaults={autoHideScrollbar:!1,setHeight:"100%",scrollInertia:500,axis:"yx",theme:"minimal-dark",advanced:{updateOnContentResize:!0},scrollButtons:{scrollAmount:"auto",enable:!1}}}]),APP.config(["$validationProvider",function(t){var e={phone:/^1[\d]{10}/,password:function(t){return t>5}},o={phone:{success:"",error:"必须是11位手机号"},password:{success:"",error:" 长度至少6位"}};t.setExpression(e).setDefaultMsg(o)}]),$.extend({getRandom:function(){var t=Math.random()+"";return t=t.split(".")[1]}}),APP.service("cache",["$cookies",function(t){this.put=function(e,o){t.put(e,o)},this.get=function(e){return t.get(e)},this.remove=function(e){t.remove(e)}}]),APP.service("$myHttp",["$rootScope","$filter","$http","$timeout","$q",function(t,e,o,n,i){this.getData=function(t,e,n){$.isFunction(n)&&n();var r=i.defer();return o({mehtod:"POST",url:t,data:e,headers:{"Content-Type":void 0}}).then(function(t){r.resolve(t)}).catch(function(t){r.reject(t)}),r.promise},this.getDataByGet=function(t,e,n){$.isFunction(n)&&n();var r=i.defer();return o.get(t,{params:e}).then(function(t){r.resolve(t)}).catch(function(t){r.reject(t)}),r.promise},this.getDataByJsonp=function(t,e,n,r){$.isFunction(r)&&r();i.defer();o.jsonp(t,{params:e,jsonpCallbackParam:n||"callback"}).then(function(t){def.resolve(t)}).catch(function(t){def.reject(t)})}}]),APP.service("uuid",["$rootScope","$filter","$http","$timeout","$q",function(t,e,o,n,i){return{getUUID:function(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var o=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?o:3&o|8).toString(16)})}}}]),APP.controller("indexCtrl",["$timeout","$log","$scope","localStorageService","$rootScope","$state","loginMode","$ngConfirm",function(t,e,o,n,i,r,a,l){console.log(r),n.get(a.NAME)!=a.RESULT&&r.go("login",{},{location:"replace"})}]),APP.filter("thousands",[function(){return function(t,e){e=e||2;var o=function(t){t=String(t).replace(",","");var o=parseFloat(t);isNaN(o)&&(o="0");for(var n="1",i=0;i<e;i++)n+="0";var r=(o=Math.round(t*n)/n).toString(),a=r.indexOf(".");for(a<0&&(a=r.length,r+=".");r.length<=a+parseInt(e);)r+="0";return r}(t).replace(/\d{1,3}(?=(\d{3})+(\.\d*)?$)/g,"$&,");return o=o.split(".")[0]+"."+o.split(".")[1].replace(",","")}}]),APP.directive("appColor",[function(){return{scope:{},restrict:"A",link:function(t,e,o,n){function i(t,n){var i,r=o.defaultColor?o.defaultColor+" !important":o.defaultColor,a=o.positiveColor?o.positiveColor+" !important":o.positiveColor,l=o.negativeColor?o.negativeColor+" !important":o.negativeColor,c=o.zeroColor?o.zeroColor+" !important":o.zeroColor,s=o.target;i=void 0!=s?s:$(e)[0].innerHTML.replace(/,/g,""),isNaN(parseFloat(i))?e.css("cssText","color:"+r):(0==i&&(c?e.css("cssText","color:"+c):a?e.css("cssText","color:"+a):e.css("cssText","color:"+r)),i>0&&(a?e.css("cssText","color:"+a):e.css("cssText","color:"+r)),i<0&&(l?e.css("cssText","color:"+l):e.css("cssText","color:"+r)))}void 0!=o.target?t.$watch(function(){return o.target},function(t,e){i(t,e)}):t.$watch(function(){return e[0].innerHTML},function(t,e){i(t,e)})}}}]),APP.directive("appCurrency",["$filter","$browser",function(t,e){return{require:"ngModel",link:function(o,n,i,r){var a={thousands:t("number")(1e3).substr(1,1),decimal:t("number")(1.1).substr(1,1)},l=!1,c=i.bit||2;r.$parsers.push(function(t){return i.isF&&t>0&&(t=-t),t+"".split(a.thousands).join("").split(a.decimal).join(".")}),r.$render=function(){n.val(t("number")((r.$viewValue+"").replace(/,/g,""),c,!1))};var s=function(){var e=n.val().split(a.thousands).join("").split(a.decimal).join(".");l?l=!1:(i.isF&&e>0&&(e=-e),n.val(t("number")(e,c)))};n.bind("focus",function(){if(!i.readonly&&"true"!=i.readonly){var t=r.$modelValue;if(!angular.isUndefined(t)){var e=t.toString().replace(/,/g,"");0==parseFloat(e)&&(e=""),n.val(e)}}}),n.bind("blur",function(){s()}),n.bind("keypress",function(t){var e=t.which;0==e||8==e||15<e&&e<19||37<=e&&e<=40||(String.fromCharCode(e)==a.thousands||String.fromCharCode(e)==a.decimal||48<=e&&e<=57||"-"==String.fromCharCode(e)?String.fromCharCode(e)==a.decimal&&(l=!0):t.preventDefault())}),n.bind("paste cut",function(){e.defer(s)})}}}]),APP.directive("appLeftRightLayout",["$timeout","uuid",function(t,e){return{templateUrl:"script/common/directive/leftRightLayout/leftRightLayout.html?t="+e.getUUID(),scope:{width:"@",height:"@",clazz:"@class",leftWidth:"@",leftStyle:"@",rightStyle:"@",centerStyle:"@",centerWidth:"@",centerIconStyle:"@"},replace:!0,transclude:{left:"?left",right:"?right"},restrict:"E",controller:["$scope",function(t){}],link:function(o,n,i,r){o.id="lrc-containerd-"+e.getUUID(),o.curIsShowLeft=!0,o.leftWidthBak=o.leftWidth;var a="glyphicon glyphicon-triangle-left";o.centerIcon=a,o.height||(o.height="100%"),o.width||(o.width="100%"),o.class||(o.class=""),o.leftWidth?(console.log(parseFloat(o.leftWidth)+10+"px"),o.leftWidth=parseFloat(o.leftWidth)+10+"px"):o.leftWidth="50%",angular.isDefined(o.leftStyle)||(o.leftStyle=""),angular.isDefined(o.rightStyle)||(o.rightStyle=""),angular.isDefined(o.centerStyle)||(o.centerStyle=""),angular.isDefined(o.centerWidth)||(o.centerWidth="13.6px"),angular.isDefined(o.centerIconStyle)||(o.centerIconStyle=""),n.find("left,right").addClass("h-100 w-100 d-ib"),$(".lrl-centerBtn").on("click",function(){o.curIsShowLeft?(o.curIsShowLeft=!1,$("#a"+o.id).animate({width:0}),$("#b"+o.id).animate({"margin-left":0}),o.leftWidth=0,t(function(){o.$apply(function(){o.centerIcon="glyphicon glyphicon-triangle-right"})},0)):(o.curIsShowLeft=!0,$("#a"+o.id).animate({width:o.leftWidthBak}),$("#b"+o.id).animate({"margin-left":o.leftWidthBak}),o.leftWidth=o.leftWidthBak,t(function(){o.$apply(function(){o.centerIcon=a})},0))})}}}]),APP.directive("script",[function(){return{restrict:"E",scope:!1,link:function(t,e,o){if("text/javascript-lazy"===o.type){var n=document.createElement("script");n.type="text/javascript";var i=e.attr("src");if(void 0!==i)n.src=i;else{var r=e.text();n.text=r}document.head.appendChild(n),e.remove()}}}}]),APP.directive("appPagePanel",["$timeout","uuid",function(t,e){return{templateUrl:"script/common/directive/pagePanel/pagePanel.html?t="+e.getUUID(),scope:{width:"@",height:"@",headStyle:"@",textAlign:"@",borderBottom:"@border",leftBtnIcon:"@",clazz:"@class"},transclude:!0,restrict:"E",controller:["$scope",function(t){}],link:function(e,o,n,i){(!e.textAlign||"left"!=e.textAlign&&"center"!=e.textAlign&&"right"!=e.textAlign)&&(e.textAlign="center"),e.height||(e.height="100%"),e.width||(e.width="100%"),e.headStyle||(e.headStyle="1"),e.borderBottom||(e.borderBottom="1px solid #D9D9D9"),e.leftBtnIcon||(e.leftBtnIcon="glyphicon glyphicon-menu-hamburger"),e.clazz||(e.clazz=""),e.showPanel=function(){o.find("#visiblePanel").removeClass("d-n").addClass("d-b")},e.hidePanel=function(){o.find("#visiblePanel").removeClass("d-b").addClass("d-n")},e.change=function(){t(function(){console.log(1111),e.$apply(function(){e.panel2=""})},2e3)},console.log(e.borderBottom)}}}]),APP.directive("appRightLeftLayout",["$timeout","uuid",function(t,e){return{templateUrl:"script/directive/leftRightLayout/rightLeftLayout.html ?t="+e.getUUID(),scope:{width:"@",height:"@",clazz:"@class",leftWidth:"@",leftStyle:"@",rightStyle:"@",centerStyle:"@",centerWidth:"@",centerIconStyle:"@"},replace:!0,transclude:{left:"?left",right:"?right"},restrict:"E",controller:["$scope",function(t){}],link:function(o,n,i,r){o.id="lrc-containerd-"+e.getUUID(),o.curIsShowLeft=!0,o.leftWidthBak=o.leftWidth;var a="glyphicon glyphicon-triangle-left";o.centerIcon=a,o.height||(o.height="100%"),o.width||(o.width="100%"),o.class||(o.class=""),o.leftWidth?(console.log(parseFloat(o.leftWidth)+10+"px"),o.leftWidth=parseFloat(o.leftWidth)+10+"px"):o.leftWidth="50%",angular.isDefined(o.leftStyle)||(o.leftStyle=""),angular.isDefined(o.rightStyle)||(o.rightStyle=""),angular.isDefined(o.centerStyle)||(o.centerStyle=""),angular.isDefined(o.centerWidth)||(o.centerWidth="13.6px"),angular.isDefined(o.centerIconStyle)||(o.centerIconStyle=""),n.find("left,right").addClass("h-100 w-100 d-ib"),$(".lrl-centerBtn").on("click",function(){o.curIsShowLeft?(o.curIsShowLeft=!1,$("#a"+o.id).animate({width:0}),$("#b"+o.id).animate({"margin-left":0}),o.leftWidth=0,t(function(){o.$apply(function(){o.centerIcon="glyphicon glyphicon-triangle-right"})},0)):(o.curIsShowLeft=!0,$("#a"+o.id).animate({width:o.leftWidthBak}),$("#b"+o.id).animate({"margin-left":o.leftWidthBak}),o.leftWidth=o.leftWidthBak,t(function(){o.$apply(function(){o.centerIcon=a})},0))})}}}]),APP.directive("appScrollLoad",["$myHttp","$log","uuid",function(t,e,o){return{template:"",scope:{url:"@",targetPush:"=",callback:"&",method:"@",params:"@",numName:"@",histroyCountName:"@",histroyCount:"@"},replace:!0,restrict:"A",controller:["$scope",function(t){}],link:function(o,n,i,r){var a=!1,l={flag:!0},c=void 0,s=angular.fromJson(o.params||"{}"),u=angular.lowercase(o.method||"post"),f=o.numName||"page",d=o.histroyCount||20,h=o.histroyCountName||"historyCountName",g=function(t){angular.isDefined(o.targetPush)&&o.targetPush.push(t),o.callback()&&o.callback()(t,l)},p=function(t){s[f]=s[f]-1,e.error("请求数据失败，请求路径"+o.url+"请求参数:"+o.params)},m=function(){a=!1},v=function(e){switch(u){case"post":t.getData(o.url,s).then(function(t){g(t),$.isFunction(e)&&e()}).catch(function(){p()}).finally(function(){m()});break;case"get":t.getDataByGet(o.url,s).then(function(t){g(t),$.isFunction(e)&&e()}).catch(function(){p()}).finally(function(){m()})}};s[f]=1,s[h]=d,v(function(){s[f]=2}),n.on("mousewheel",function(){if(c=n.closest(".mCustomScrollBox").next().find(".mCSB_dragger").css("bottom"),parseInt(c)<1&&!a&&l.flag)a=!0,s[f]=s[f]+1,v();else{var t=n.children(":last-child").val();console.log(t)}})}}}]),APP.controller("homeCtrl",["$rootScope","$scope","$log","localStorageService","loginMode","$state","$timeout","$ngConfirm",function(t,e,o,n,i,r,a,l){e.loginOut=function(){l({theme:"supervan",title:"提示!",content:"<strong>您确定要退出吗?</strong>",scope:e,buttons:{sayBoo:{text:"确定",btnClass:"btn-blue",action:function(t,e){return n.remove(i.NAME),r.go("login",{},{location:"replace"}),!0}},close:{text:"取消",btnClass:"btn-default"}}})},e.showUserInfo=function(){e.userInfoMode?e.userInfoMode=!1:e.userInfoMode=!0}}]),APP.controller("loginCtrl",["$rootScope","$scope","$log","localStorageService","loginMode","$state","$timeout","$location",function(t,e,o,n,i,r,a,l){n.get(i.NAME)==i.RESULT&&r.go("home.main",{},{location:"replace"}),e.login=function(){n.set(i.NAME,i.RESULT),r.go("home.main",{},{absolute:!0,location:"replace"})}}]),APP.directive("dropseaNavUserInfo",["uuid",function(t){return{templateUrl:"script/platform/directive/navUserInfo/navUserInfo.html?t="+t.getUUID(),scope:{},replace:!0,restrict:"E",controller:["$scope",function(t){}],link:function(t,e,o,n){}}}]),APP.controller("mainCtrl",["$scope","$timeout","$myHttp","cache","$log",function(t,e,o,n,i){e(function(){i.info("info")},0),t.params={page:4},t.money=4544444444444444,t.handler=function(){return function(e,o){o.flag=e.data.object.hasMoreData,t.items.push(e.data.object.data)}},t.name="jsdf",t.scrollbarConfig={setHeight:200},t.items=["张三"];for(var r=0;r<30;r++)t.items.push("lisi"+r);t.showBgPanel=!1,t.mydate="2017",t.add=function(){t.aaa="2342423",o.getDataByGet("data/data.json").then(function(i){return n.put("a","aa"),e(function(){t.$digest(),t.$apply(function(){t.data+=i})},0),o.getDataByGet("data/test.json")}).then(function(e){console.log(e),t.items.push(e)}).catch(function(t){console.log(t)}).finally(function(){console.log("请求结束")})}}]),APP.controller("organizationCtrl",["$scope","$timeout","$myHttp","cache","$log",function(t,e,o,n,i){}]);